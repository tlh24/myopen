function [xx,yy,zz] = fingertip(len,rad)
%THUMB_BASE Generate base of thumb segment.
%   [X,Y,Z] = THUMB_BASE(LEN,RAD) forms the thumb base segment with length LEN
%   and with radius scaled by RAD (which is the max radius of the segment)
%   
%   [X,Y,Z] = THUMB_BASE defaults to LEN = 2.5 and RAD = 1.

%   Blair Lock 06-09-04

if nargin < 2, rad = 1; len = 2.5; end

x = [ 0.5000    0.5000    0.5000    0.5000    0.5000    0.5000    0.5000    0.5000    0.5000    0.5000    0.5000;...
      0.6000    0.5618    0.4618    0.3382    0.2382    0.2000    0.2382    0.3382    0.4618    0.5618    0.6000;...
      0.7000    0.6236    0.4236    0.1764    0.0236         0    0.0236    0.1764    0.4236    0.6236    0.7000;...
      0.8000    0.6854    0.3854    0.0146   -0.2854   -0.4000   -0.2854    0.0146    0.3854    0.6854    0.8000;...
      0.9000    0.7472    0.3472   -0.1472   -0.5472   -0.7000   -0.5472   -0.1472    0.3472    0.7472    0.9000;...
      1.0000    0.8090    0.3090   -0.3090   -0.8090   -1.0000   -0.8090   -0.3090    0.3090    0.8090    1.0000;...
      1.0000    0.8090    0.3090   -0.3090   -0.8090   -1.0000   -0.8090   -0.3090    0.3090    0.8090    1.0000;...
      0.9511    0.7694    0.2939   -0.2939   -0.7694   -0.9511   -0.7694   -0.2939    0.2939    0.7694    0.9511;...
      0.8090    0.6545    0.2500   -0.2500   -0.6545   -0.8090   -0.6545   -0.2500    0.2500    0.6545    0.8090;...
      0.5878    0.4755    0.1816   -0.1816   -0.4755   -0.5878   -0.4755   -0.1816    0.1816    0.4755    0.5878;...
      0.3090    0.2500    0.0955   -0.0955   -0.2500   -0.3090   -0.2500   -0.0955    0.0955    0.2500    0.3090;...
           0         0         0         0         0         0         0         0         0         0         0;...
    ];
y = [      0         0         0         0         0         0         0         0         0         0         0;...
           0    0.1195    0.1903    0.1903    0.1195         0   -0.1195   -0.1903   -0.1903   -0.1195         0;...
           0    0.2371    0.3805    0.3805    0.2371         0   -0.2371   -0.3805   -0.3805   -0.2371         0;...
           0    0.3527    0.5707    0.5707    0.3527         0   -0.3527   -0.5707   -0.5707   -0.3527         0;...
           0    0.4702    0.7609    0.7609    0.4702         0   -0.4702   -0.7609   -0.7609   -0.4702         0;...
           0    0.5878    0.9511    0.9511    0.5878         0   -0.5878   -0.9511   -0.9511   -0.5878         0;...
           0    0.5878    0.9511    0.9511    0.5878         0   -0.5878   -0.9511   -0.9511   -0.5878         0;...
           0    0.5590    0.9045    0.9045    0.5590         0   -0.5590   -0.9045   -0.9045   -0.5590         0;...
           0    0.4755    0.7694    0.7694    0.4755         0   -0.4755   -0.7694   -0.7694   -0.4755         0;...
           0    0.3455    0.5590    0.5590    0.3455         0   -0.3455   -0.5590   -0.5590   -0.3455         0;...
           0    0.1816    0.2939    0.2939    0.1816         0   -0.1816   -0.2939   -0.2939   -0.1816         0;...
           0         0         0         0         0         0         0         0         0         0         0;...
    ];
z = [      0         0         0         0         0         0         0         0         0         0         0;...
      0.0008    0.0008    0.0008    0.0008    0.0008         0    0.0008    0.0008    0.0008    0.0008    0.0008;...
      0.0128    0.0128    0.0128    0.0128    0.0128         0    0.0128    0.0128    0.0128    0.0128    0.0128;...
      0.0648    0.0648    0.0648    0.0648    0.0648    0.0648    0.0648    0.0648    0.0648    0.0648    0.0648;...
      0.2048    0.2048    0.2048    0.2048    0.2048    0.2048    0.2048    0.2048    0.2048    0.2048    0.2048;...
      0.5000    0.5000    0.5000    0.5000    0.5000    0.5000    0.5000    0.5000    0.5000    0.5000    0.5000;...
      1.0000    1.0000    1.0000    1.0000    1.0000    1.0000    1.0000    1.0000    1.0000    1.0000    1.0000;...
      0.3090    0.3090    0.3090    0.3090    0.3090    0.3090    0.3090    0.3090    0.3090    0.3090    0.3090;...
      0.5878    0.5878    0.5878    0.5878    0.5878    0.5878    0.5878    0.5878    0.5878    0.5878    0.5878;...
      0.8090    0.8090    0.8090    0.8090    0.8090    0.8090    0.8090    0.8090    0.8090    0.8090    0.8090;...
      0.9511    0.9511    0.9511    0.9511    0.9511    0.9511    0.9511    0.9511    0.9511    0.9511    0.9511;...
      1.0000    1.0000    1.0000    1.0000    1.0000    1.0000    1.0000    1.0000    1.0000    1.0000    1.0000;...
    ];

xx = x.*rad;    % scaling
yy = y.*rad;    % scaling
z([8:12],:) = z([8:12],:).*rad/len + 1;
zz = -z.*len;   % scaling

%surf(xx,yy,zz); xlabel('x'); ylabel('y');