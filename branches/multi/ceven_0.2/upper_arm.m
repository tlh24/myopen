function [xx,yy,zz] = upper_arm(len,rad)
%UPPER_ARM Generate upper arm.
%   [X,Y,Z] = UPPER_ARM(LEN,RAD) forms the upper arm segment with length LEN
%   and with radius scaled by RAD (which is the radius of the elbow end of the 
%   elbow end of the segment)
%   
%   [X,Y,Z] = UPPER_ARM(LEN) defaults to RAD = 5, and [X,Y,Z] = UPPER_ARM 
%   defaults to LEN = 30 and RAD = 5.

%   Blair Lock 06-03-04

if nargin < 2, rad = 5; end
if nargin < 1, len = 30; end

x =  [     0         0         0         0         0         0         0         0         0         0         0         0;...
      1.2000    1.0095    0.4985   -0.1708   -0.7858   -1.1514   -1.1514   -0.7858   -0.1708    0.4985    1.0095    1.2000;...     
      1.0000    0.8413    0.4154   -0.1423   -0.6549   -0.9595   -0.9595   -0.6549   -0.1423    0.4154    0.8413    1.0000;...
      0.9898    0.8327    0.4112   -0.1409   -0.6482   -0.9497   -0.9497   -0.6482   -0.1409    0.4112    0.8327    0.9898;...
      0.9096    0.7652    0.3779   -0.1295   -0.5957   -0.8728   -0.8728   -0.5957   -0.1295    0.3779    0.7652    0.9096;...
      0.7557    0.6358    0.3139   -0.1076   -0.4949   -0.7251   -0.7251   -0.4949   -0.1076    0.3139    0.6358    0.7557;...
      0.5406    0.4548    0.2246   -0.0769   -0.3540   -0.5187   -0.5187   -0.3540   -0.0769    0.2246    0.4548    0.5406;...
      0.2817    0.2370    0.1170   -0.0401   -0.1845   -0.2703   -0.2703   -0.1845   -0.0401    0.1170    0.2370    0.2817;...
           0         0         0         0         0         0         0         0         0         0         0         0;...
     ];
y =  [     0         0         0         0         0         0         0         0         0         0         0         0;...
           0    0.6488    1.0916    1.1878    0.9069    0.3381   -0.3381   -0.9069   -1.1878   -1.0916   -0.6488         0;...  
           0    0.5406    0.9096    0.9898    0.7557    0.2817   -0.2817   -0.7557   -0.9898   -0.9096   -0.5406         0;...
           0    0.5351    0.9004    0.9797    0.7481    0.2789   -0.2789   -0.7481   -0.9797   -0.9004   -0.5351         0;...
           0    0.4918    0.8274    0.9004    0.6875    0.2563   -0.2563   -0.6875   -0.9004   -0.8274   -0.4918         0;...
           0    0.4086    0.6875    0.7481    0.5712    0.2129   -0.2129   -0.5712   -0.7481   -0.6875   -0.4086         0;...
           0    0.2923    0.4918    0.5351    0.4086    0.1523   -0.1523   -0.4086   -0.5351   -0.4918   -0.2923         0;...
           0    0.1523    0.2563    0.2789    0.2129    0.0794   -0.0794   -0.2129   -0.2789   -0.2563   -0.1523         0;...
           0         0         0         0         0         0         0         0         0         0         0         0;...
     ];

z =  [     0         0         0         0         0         0         0         0         0         0         0         0;...
           0         0         0         0         0         0         0         0         0         0         0         0;...
           0         0         0         0         0         0         0         0         0         0         0         0;...
      0.1423    0.1423    0.1423    0.1423    0.1423    0.1423    0.1423    0.1423    0.1423    0.1423    0.1423    0.1423;...
      0.4154    0.4154    0.4154    0.4154    0.4154    0.4154    0.4154    0.4154    0.4154    0.4154    0.4154    0.4154;...
      0.6549    0.6549    0.6549    0.6549    0.6549    0.6549    0.6549    0.6549    0.6549    0.6549    0.6549    0.6549;...
      0.8413    0.8413    0.8413    0.8413    0.8413    0.8413    0.8413    0.8413    0.8413    0.8413    0.8413    0.8413;...
      0.9595    0.9595    0.9595    0.9595    0.9595    0.9595    0.9595    0.9595    0.9595    0.9595    0.9595    0.9595;...
      1.0000    1.0000    1.0000    1.0000    1.0000    1.0000    1.0000    1.0000    1.0000    1.0000    1.0000    1.0000;...
     ];

xx = x.*rad;        % scaling
yy = y.*rad;        % scaling
zz = -z.*rad - len; % scaling and translation
zz([1 2],:) = 0;    % zeroing base points after translation
 
%surf(xx,yy,zz); xlabel('x'); ylabel('y');
 
