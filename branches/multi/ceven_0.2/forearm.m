function [xx,yy,zz] = forearm(len,rad)
%FOREARM Generate forearm.
%   [X,Y,Z] = FOREARM(LEN,RAD) forms the forearm segment with length LEN
%   and with radius scaled by RAD (which is the radius of the elbow end of the 
%   elbow end of the segment)
%   
%   [X,Y,Z] = FOREARM(LEN) defaults to RAD = 5, and [X,Y,Z] = FOREARM 
%   defaults to LEN = 30 and RAD = 5.

%   Note: The wrist end of the segment is an ellipsoid in shape with radii of
%         0.7(RAD), 0.4(RAD), and 0.4(RAD). 

%   Blair Lock 06-03-04

if nargin < 2, rad = 5; end
if nargin < 1, len = 30; end

x =  [     0         0         0         0         0         0         0         0         0         0         0;...
           0    0.5878    0.9511    0.9511    0.5878    0.0000   -0.5878   -0.9511   -0.9511   -0.5878         0;...     
           0    0.2351    0.3804    0.3804    0.2351         0   -0.2351   -0.3804   -0.3804   -0.2351         0;...
           0    0.2236    0.3618    0.3618    0.2236         0   -0.2236   -0.3618   -0.3618   -0.2236         0;...
           0    0.1902    0.3078    0.3078    0.1902         0   -0.1902   -0.3078   -0.3078   -0.1902         0;...
           0    0.1382    0.2236    0.2236    0.1382         0   -0.1382   -0.2236   -0.2236   -0.1382         0;...
           0    0.0727    0.1176    0.1176    0.0727         0   -0.0727   -0.1176   -0.1176   -0.0727         0;...
           0         0         0         0         0         0         0         0         0         0         0;...
     ];
y =  [     0         0         0         0         0         0         0         0         0         0         0;...
      1.0000    0.8090    0.3090   -0.3090   -0.8090   -1.0000   -0.8090   -0.3090    0.3090    0.8090    1.0000;...     
      0.7000    0.5663    0.2163   -0.2163   -0.5663   -0.7000   -0.5663   -0.2163    0.2163    0.5663    0.7000;...
      0.6657    0.5386    0.2057   -0.2057   -0.5386   -0.6657   -0.5386   -0.2057    0.2057    0.5386    0.6657;...
      0.5663    0.4582    0.1750   -0.1750   -0.4582   -0.5663   -0.4582   -0.1750    0.1750    0.4582    0.5663;...
      0.4114    0.3329    0.1271   -0.1271   -0.3329   -0.4114   -0.3329   -0.1271    0.1271    0.3329    0.4114;...
      0.2163    0.1750    0.0668   -0.0668   -0.1750   -0.2163   -0.1750   -0.0668    0.0668    0.1750    0.2163;...
           0         0         0         0         0         0         0         0         0         0         0;...
     ];
z =  [     0         0         0         0         0         0         0         0         0         0         0;...     
           0         0         0         0         0         0         0         0         0         0         0;...
           0         0         0         0         0         0         0         0         0         0         0;...
      0.1236    0.1236    0.1236    0.1236    0.1236    0.1236    0.1236    0.1236    0.1236    0.1236    0.1236;...
      0.2351    0.2351    0.2351    0.2351    0.2351    0.2351    0.2351    0.2351    0.2351    0.2351    0.2351;...
      0.3236    0.3236    0.3236    0.3236    0.3236    0.3236    0.3236    0.3236    0.3236    0.3236    0.3236;...
      0.3804    0.3804    0.3804    0.3804    0.3804    0.3804    0.3804    0.3804    0.3804    0.3804    0.3804;...
      0.4000    0.4000    0.4000    0.4000    0.4000    0.4000    0.4000    0.4000    0.4000    0.4000    0.4000;...
     ];

xx = x.*rad;        % scaling
yy = y.*rad;        % scaling
zz = -z.*rad - len; % scaling and translation
zz([1 2],:) = 0;    % zeroing base points after translation

%surf(xx,yy,zz); xlabel('x'); ylabel('y');